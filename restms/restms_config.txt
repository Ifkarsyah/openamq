Using command-line options
==========================

You can set these options from the command-line; they affect only
the specific instance of the running server:

    --server_name www.restms.com   Announced server name
    --port 80                      Server port for HTTP requests
    --public_port value            Public port for HTTP requests
    --trace 0                      Trace network traffic?
    --animate 0                    Animate HTTP agent?
    --verbose 0                    Verbose output?
    --listen *                     Address (local network interface) to listen on
    --amqp_hostname localhost      AMQP server to connect to
    --amqp_username guest          AMQP user name
    --amqp_password guest          AMQP password
    --webroot webpages             Path to web root directory
    --index index.html             Index file name
    --default_types .pdf .html     Default document types
    --max_memory_mb 512            Maximum allowed memory, MBytes
    --request_timeout 0            Timeout for request processing.
    --monitor 0                    Monitor interval, seconds
    --record_stats 0               Record performance statistics
    --log_path logs                Active log file directory
    --keep_logs 1                  Keep log files
    --archive_path archive         Archive log file directory
    --archive_cmd value            Archive log file command
    --alert_log alert.log          Error log file name
    --daily_log daily.log          Daily log file name
    --debug_log debug.log          Debug log file name
    --access_log access.log        Access log file name
    --header_max 32000             Max size of HTTP header
    --read_timeout 60              Network read timeout, seconds
    --write_timeout 60             Network write timeout, seconds
    --tcp_nodelay 1                TCP/IP NODELAY option
    --tcp_rcvbuf 0                 TCP/IP receive buffer, in bytes
    --tcp_sndbuf 0                 TCP/IP send buffer, in bytes
    --polling_threads 4            Number of polling OS threads
    --working_threads 4            Number of working OS threads
    --auto_crash 0                 Auto-crash test timer, seconds
    --auto_block 0                 Auto-freeze test timer, seconds
    --kernel_limit 0               SMT kernel limit

Creating a configuration file
=============================

You can also set the above options in an XML text file, to affect
all future instances of the running server. To create a new XML
configuration file, copy the following block to an editor session,
and then:

 1. Delete all options you want to leave as default.
 2. Delete this comment and update your name and the date.
 3. Save file as new restms.cfg or merge with existing copy.
 4. Restart the server.

    <?xml version="1.0"?>
    <!--
        Revised: yyyy/mm/dd by yourname
     -->
    
    <config>
        <server
            name = "www.restms.com"
            port = "80"
            public_port = "value"
            trace = "0"
            animate = "0"
            verbose = "0"
            listen = "*"
        />
        <amqp
            hostname = "localhost"
            username = "guest"
            password = "guest"
        />
        <host
            webroot = "webpages"
            index = "index.html"
            default_types = ".pdf .html"
        />
        <resources
            max_memory_mb = "512"
            request_timeout = "0"
            monitor = "0"
            record_stats = "0"
        />
        <logging
            log_path = "logs"
            keep_logs = "1"
            archive_path = "archive"
            archive_cmd = "value"
            alert_log = "alert.log"
            daily_log = "daily.log"
            debug_log = "debug.log"
            access_log = "access.log"
        />
        <tuning
            header_max = "32000"
            read_timeout = "60"
            write_timeout = "60"
            tcp_nodelay = "1"
            tcp_rcvbuf = "0"
            tcp_sndbuf = "0"
            polling_threads = "4"
            working_threads = "4"
        />
        <internal
            auto_crash = "0"
            auto_block = "0"
            kernel_limit = "0"
        />
    </config>

Setting server options
===========================

name = "www.restms.com":
    Specifies the Server: header field name for HTTP responses. Default
    value is www.restms.com.                                           
port = "80":
    Specifies the port that the server opens for HTTP requests. The       
    standard port for HTTP is 80. If you want to run the server in        
    parallel with other HTTP servers on the same server, choose a server  
    port of 4096 or higher. If you are serving Internet clients, your     
    network may map a public port to the server port number. In that case,
    you may need to specify the public port number separately. Default    
    value is 80.                                                          
public_port = "value":
    Specifies the public port for client requests, if not the standard  
    port number for HTTP (80). The server needs to know this value in   
    order to format accurate redirection responses. Default value is not
    defined.                                                            
trace = "0":
    If set, the HTTP agent displays all socket i/o, which can be useful if
    you need to verify what exactly web clients are sending and getting   
    back from the server. Do not enable this with high loads because you  
    will get enormous amounts of output. Default value is 0.              
animate = "0":
    If set, the HTTP agent displays its activity, which can be useful if
    you need to verify how HTTP requests are being processed. Do not    
    enable this with high loads because you will get enormous amounts of
    output. Default value is 0.                                         
verbose = "0":
    If set, the HTTP agent displays all input and output headers, which  
    can be useful for debugging configuration issues. Default value is 0.
listen = "*":
    Specifies the network interface on which the server should listen for
    connections. By default this is *, meaning all interfaces. You would 
    choose to set an address when you use this application on a box with 
    multiple network interfaces, e.g. routing between two networks.      
    Default value is *.                                                  

Setting amqp options
===========================

hostname = "localhost":
    Specifies the hostname and optionally port number to connect to.
    Default value is localhost.                                     
username = "guest":
    Specifies the user name to use for AMQP connections. Default value is
    guest.                                                               
password = "guest":
    Specifies the password to use for AMQP connections. Credentials are  
    always passed using the SASL BASIC mechanism. Default value is guest.

Setting host options
===========================

webroot = "webpages":
    Specifies the web root directory. Normally this is used to hold static
    resources - HTML, images, etc. The web root maps to the / URI. Default
    value is webpages.                                                    
index = "index.html":
    Specifies the file that is returned to the browser when an empty URL  
    is specified (the URI refers to a directory name). Common choicse are 
    index.html and default.html. If the index file is not present in a    
    directory, the server will look for a file called .httpdir and if that
    is present, it will format a directory listing. Default value is      
    index.html.                                                           
default_types = ".pdf .html":
    Specifies a list of default document types. The server implements a   
    feature called 'default typing' in which you can specify URIs without 
    file extensions. The default types are specified in order. You can use
    this to publish a URI that specifies an HTML document, for example,   
    and later replace it with a PDF without breaking the published URI.   
    Default value is .pdf .html.                                          

Setting resources options
===========================

max_memory_mb = "512":
    Specifies the maximum memory allowed for the server, in MB. When the
    server reaches this limit, it will slow down publishers. If zero, no
    limit is enforced. Default value is 512.                            
request_timeout = "0":
    Specifies the limit, in seconds, for any request. If this is set to a
    non-zero value then requests that are not handled (internally by a   
    request handler) within this timeout will be killed. Note that       
    individual handlers can override this timeout. Default value is 0.   
monitor = "0":
    Specifies the interval in seconds at which the server will report its
    request/response rates. If zero, no monitoring is shown. The         
    recommended value is 1, if monitoring is desired. Default value is 0.
record_stats = "0":
    Specifies whether or not the server records performance statistics in 
    a format suitable for importing into a spreadsheet. If set, the server
    creates a file called 'http_stats_(portnumber).del' which contains    
    performance statistics in a comma-delimited format. For this setting  
    to take effect, the monitor option must also be set. Default value is 
    0.                                                                    

Setting logging options
===========================

log_path = "logs":
    Specifies the directory path into which active log files are placed.
    Default value is logs.                                              
keep_logs = "1":
    Specifies whether or not the server should keep logs. If zero, the 
    server will not keep logs. If 1, it will keep an alert log, a daily
    log, and a debug log as specified. Default value is 1.             
archive_path = "archive":
    Specifies the directory path into which archived log files are placed.
    This can be the same as the active path; archived log files are       
    renamed to avoid conflict with active log files. Default value is     
    archive.                                                              
archive_cmd = "value":
    If specified, this command is run on all archived log files. You can 
    use this option to compress archived log files, or clean up old and  
    unwanted files. When the command is run, the name of the archived log
    file is provided to it as a single argument. Default value is not    
    defined.                                                             
alert_log = "alert.log":
    The name of the alert log file, which records all errors and warnings 
    issued by the server. Note that the server port number is always added
    to the name of the log file. Default value is alert.log.              
daily_log = "daily.log":
    The name of the daily log file, which records all normal activity as
    well as errors. Note that the server port number is always added to 
    the name of the log file. Default value is daily.log.               
debug_log = "debug.log":
    The name of the debug log file, which records all normal activity,   
    errors, and debug trace information. Note that the server port number
    is always added to the name of the log file. Default value is        
    debug.log.                                                           
access_log = "access.log":
    The name of the access log file, which records all HTTP requests. Note
    that the server port number is always added to the name of the log    
    file. Default value is access.log.                                    

Setting tuning options
===========================

header_max = "32000":
    Defines the limit for HTTP headers; the server will accept up to this
    much data. You can increase the limit if you have applications that  
    pass excessive amounts of data as URI arguments, but usually it is   
    recommended to pass large web forms as POST body data. Default value 
    is 32000.                                                            
read_timeout = "60":
    Defines the timeout for network reads. If a client does not send data 
    within this time, it is considered dead. If you get unexpected timeout
    errors in the logs, you may want to increase this value. Default value
    is 60.                                                                
write_timeout = "60":
    Defines the timeout for network writes. If a client does not accept
    data within this time, it is considered dead. If you get unexpected
    timeout errors in the logs, you may want to increase this value.   
    Default value is 60.                                               
tcp_nodelay = "1":
    If this value is 1, socket data is written immediately, which is     
    usually good for latency. If this value is 0, data is buffered until 
    there is a full packet, which is usually good for throughput. Default
    value is 1.                                                          
tcp_rcvbuf = "0":
    If this value is greater than zero, all client connections will use  
    the specified value. Note: setting this value is delicate, do not use
    this option unless you know what you are doing. Default value is 0.  
tcp_sndbuf = "0":
    If this value is greater than zero, all client connections will use  
    the specified value. Note: setting this value is delicate, do not use
    this option unless you know what you are doing. Default value is 0.  
polling_threads = "4":
    On multithreaded builds, defines the number of OS threads dedicated to
    socket polling. Only used in stand-alone HTTP servers. Default value  
    is 4.                                                                 
working_threads = "4":
    On multithreaded builds, defines the number of OS threads dedicated to
    processing, that is, tasks other than socket polling. Only used in    
    stand-alone HTTP servers. Default value is 4.                         

Setting internal options
===========================

auto_crash = "0":
    If set, the server will crash at irregular intervals, being some     
    random point within the number of seconds specified. This is used    
    specifically to test applications for failover and robustness. Set to
    zero for all real usage. Default value is 0.                         
auto_block = "0":
    If set, the server will block at irregular intervals, being some     
    random point within the number of seconds specified. This is used    
    specifically to test applications for failover and robustness. Set to
    zero for all real usage. Default value is 0.                         
kernel_limit = "0":
    Sets an action limit for the SMT kernel: after this many steps it will
    exit. Use this to break the server for failure testing. Set to zero   
    for all real usage. Default value is 0.                               


