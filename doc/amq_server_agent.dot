digraph ServerAgent {
    size = "6,12";
    node [fontsize=30];
    subgraph master {
        initialise_master -> new_connection;
        new_connection -> new_connection;
    }
    subgraph client {
        initialise_connection -> expect_connection_response;
        expect_connection_response -> expect_connection_tune;
        expect_connection_response -> expect_connection_response;
        expect_connection_tune -> expect_connection_tune;
        expect_connection_tune -> connection_active;
        connection_active -> connection_active;
        connection_active -> have_channel_open;
        connection_active -> have_channel_method;
        connection_active -> have_channel_send;
        connection_active -> have_channel_prepare;
        connection_active -> have_channel_close;
        connection_active -> sending_message;
        have_channel_open -> connection_active;
        have_channel_open -> have_channel_open;
        have_channel_method -> connection_active;
        have_channel_send -> after_channel_send;
        have_channel_send -> connection_active;
        after_channel_send -> expect_channel_send;
        after_channel_send -> connection_active;
        expect_channel_send -> after_channel_send;
        expect_channel_send -> connection_active;
        have_channel_prepare -> after_channel_send;
        have_channel_close -> have_channel_close;
        have_channel_close -> connection_active;
        sending_message -> sending_message;
        sending_message -> connection_active;
    }
}
