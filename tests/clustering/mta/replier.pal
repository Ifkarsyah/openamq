<?xml?>
<pal
    script = "amq_pal_gen"
    desc   = "replier side or req/rep scenario"
    >    

    <session>
        <exchange_declare exchange = "replies" type = "direct" />
        <queue_declare durable = "0" auto_delete = "1" />
        <queue_bind queue = "$queue" exchange = "amq.direct" />
        <basic_consume queue = "$queue" />
        <wait timeout = "10000" />
        <basic_arrived>
            <echo>Request received</echo>
            <basic_content message_id = "reply" />
            <basic_publish routing_key = "rk" exchange = "replies"/>
            <echo>Reply sent</echo>
        </basic_arrived>
<!--
        <empty>
            <abort>E: Request haven't reached remote server</abort>
        </empty>
-->
    </session>
    
</pal>
